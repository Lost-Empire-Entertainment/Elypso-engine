# Elypso Engine Documentation

## Overview
Elypso Engine is a lightweight, modern C++20 game engine built on top of Kalawindow.  
It provides the full Editor application for designing, building, and managing projects, while exposing its runtime through versioned DLLs for use by games.  
Both Elypso Engine (Editor EXE) and games use the same DLL, ensuring consistent behavior.

---

## Distribution
- **Elypso Engine (EXE)**  
  - The full Editor application.  
  - Provides UI for project management, scene editing, and asset inspection.  
  - Runs projects using the same engine runtime as games.  

- **Versioned Engine DLL**  
  - Example: `Elypso_engine_01.dll`.  
  - Contains the runtime codebase for Elypso Engine.  
  - Exposes the API for scenes, assets, GameObjects, and Components.  
  - Shared by both Elypso Engine (EXE) and games.  
  - Versioning ensures project–engine compatibility is deterministic.  

- **Template Projects**  
  - Game source code generated by Elypso Hub.  
  - Link against the specific versioned DLL their `.eproj` targets.  
  - Developers extend the template with gameplay code.  
  - Produces standalone executables.  

---

## Responsibilities
- Authoring and editing scenes through Elypso Engine (EXE).  
- Running and compiling games against the appropriate `Elypso_engine_##.dll`.  
- Providing APIs for core systems:
  - Scene management.  
  - GameObject and Component model.  
  - Asset management and loading.  
  - Rendering, audio, and input (via Kalawindow).  

---

## Scene System
- **Scene Files (`.escn`)**  
  - Store metadata, GameObject hierarchy, and per-object component data.  
  - Binary format for efficiency, with optional text format during early development.  
  - References assets by path, not embedded.  

- **Scene Lifecycle**  
  - Created via `Scene::create()` (from file path or empty).  
  - Owned by the engine as `unique_ptr`.  
  - Removing a scene cleans up all GameObjects and Components deterministically.  
  - Elypso Engine loads one scene at a time; games may load/unload scenes at runtime.  

---

## GameObject and Component Model
- **GameObject**  
  - Core entity container.  
  - Stores ID, name, and component list.  
  - Owned by a Scene with `unique_ptr`.  

- **Components**  
  - Owned by GameObjects with `unique_ptr`.  
  - Define functionality such as transforms, rendering, audio, or physics.  
  - Use inheritance-based design, not ECS.  

- **Ownership Model**  
  - Strict RAII with `unique_ptr` across Scene → GameObject → Component.  
  - No `shared_ptr` or `weak_ptr`.  
  - Guarantees deterministic cleanup.  

- **Enable/Disable**  
  - Disabling an object unloads its assets.  
  - Disabling a parent cascades to all children.  

---

## Asset Management
- On build, Elypso Engine compiles each scene into:  
  - `.escn` (scene structure).  
  - `.kdat` (assets used in that scene).  

- **`.kdat`**  
  - Custom binary archive format from Kaladata.  
  - Stores asset name, path, and raw file data.  
  - Supports deduplication: repeated assets are replaced with references to the original storage.  

- **Loading Behavior**  
  - In Elypso Engine (EXE): all assets for the active scene are loaded immediately.  
  - In games: developers control asset loading/unloading through enable/disable flags in the scene.  

---

## Project Workflow
1. **Create Project** in Elypso Hub (`.eproj` generated).  
2. **Edit Scenes** in Elypso Engine (EXE), saved as `.escn` + `.kdat`.  
3. **Compile Game** from a template project:  
   - Links against the specific `Elypso_engine_##.dll`.  
   - Developers implement gameplay code in C++20.  
   - Produces a standalone executable.  